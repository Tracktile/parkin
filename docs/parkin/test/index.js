var be=Object.create;var V=Object.defineProperty;var Oe=Object.getOwnPropertyDescriptor;var je=Object.getOwnPropertyNames;var we=Object.getPrototypeOf,$e=Object.prototype.hasOwnProperty;var Se=(n,i)=>()=>(i||n((i={exports:{}}).exports,i),i.exports),Ae=(n,i)=>{for(var c in i)V(n,c,{get:i[c],enumerable:!0})},se=(n,i,c,d)=>{if(i&&typeof i=="object"||typeof i=="function")for(let h of je(i))!$e.call(n,h)&&h!==c&&V(n,h,{get:()=>i[h],enumerable:!(d=Oe(i,h))||d.enumerable});return n};var jt=(n,i,c)=>(c=n!=null?be(we(n)):{},se(i||!n||!n.__esModule?V(c,"default",{value:n,enumerable:!0}):c,n)),xe=n=>se(V({},"__esModule",{value:!0}),n);var Y=Se((Z,oe)=>{(function(n,i){typeof Z=="object"&&typeof oe<"u"?i(Z):typeof define=="function"&&define.amd?define(["exports"],i):i((n=typeof globalThis<"u"?globalThis:n||self).jsutils={})})(Z,function(n){"use strict";let i={SHOULD_LOG:!0,SHOULD_THROW:!1,LOG_PREFIX:null},c=()=>!0,d=(t,e={},r={})=>{let{logs:s=i.SHOULD_LOG,throws:o=i.SHOULD_THROW,prefix:a=i.LOG_PREFIX}=r,l=Object.entries(t).map(([S,M])=>h(S,M,e[S]||e.$default||c)),{success:f,cases:j}=l.reduce((S,M)=>b(S,M,{logs:s,throws:o,prefix:a}),{success:!0,cases:{}});return[f,j]};d.setOptions=({logs:t,throws:e,prefix:r})=>{t!==void 0&&(i.SHOULD_LOG=t),e!==void 0&&(i.SHOULD_THROW=e),r!==void 0&&(i.LOG_PREFIX=r)},d.resetOptions=()=>{i.SHOULD_LOG=!0,i.SHOULD_THROW=!1,i.LOG_PREFIX=null};let h=(t,e,r)=>{let s=r(e),o=!r.name||r.name===t||r.name==="$default"?r.toString():r.name;return{success:s,key:t,value:e,validator:r,reason:s?null:[`Argument "${t}" with value `,e,` failed validator: ${o}.`]}},b=(t,e,{logs:r,throws:s,prefix:o})=>(!e.success&&A(e,r,s,o),{success:t.success&&e.success,cases:{...t.cases,[e.key]:e}}),A=(t,e,r,s)=>{let o=s?[s,...t.reason]:t.reason;if(r)throw new Error(o.join());e&&console.error(...o)},p=t=>Array.isArray(t),E=t=>{let e=new Map;for(let s=0;s<t.length;s++){var r;let o=t[s],a=(r=e.get(o))!==null&&r!==void 0?r:0;e.set(o,a+1)}return e},w=(t,e)=>{if(t.size!==e.size)return!1;for(let[r,s]of t)if(e.get(r)!==s)return!1;return!0},m=t=>typeof t=="object"&&!Array.isArray(t)&&t!==null,R=t=>p(t)?t:[t],u=t=>typeof t=="function",x=t=>(Object.freeze(t),Object.getOwnPropertyNames(t).map(e=>{t.hasOwnProperty(e)&&t[e]!==null&&(typeof t[e]=="object"||u(t[e]))&&!Object.isFrozen(t[e])&&x(t[e])}),t),O=Object.freeze({}),D=x({content:{}}),I=x([]),P=t=>t==t&&t!=null,q=(t,e,r)=>{for(let s=0;s<t.length;s++){let o=t[s];p(o)?q(o,e,r):r.exists&&!P(o)||r.truthy&&!o||e.push(o)}return r.mutate?(Object.assign(t,e).splice(e.length),t):e},z=(t,e)=>q(t,[],m(e)?e:O),St=(t,e)=>{if(p(e)){let[r,...s]=e;return r(t,...s)}return u(e)?e(t):(console.error("Pipeline expected either a function or an array (for function expressions). Found "+typeof e),t)},rt=(t,...e)=>e.reduce((r,s)=>St(r,s),t),g=t=>typeof t=="string",At=(t,e)=>{if(!g(t)||!u(e))return t;let r="";for(let s of t)r+=e(s);return r},xt=t=>t===t.toLowerCase(),vt=t=>t===t.toUpperCase(),Et=(t,e,r=["-","_"," "])=>{if(!g(t))return t;let s=a=>r.some(l=>l===a),o="_";return At(t,a=>s(a)?(o=e,e):vt(a)&&xt(o)&&!s(o)?(o=a,e+a):(o=a,a))},X=(t,e=!0)=>{if(!g(t)||!t[0])return t;let r=e?t.slice(1).toLowerCase():t.slice(1);return`${t[0].toUpperCase()}${r}`},Rt=t=>{let e=t.indexOf(".")===0?t.slice(1):t;return e.indexOf(".")===e.length-1?e.slice(0,-1):e},nt=t=>t&&Rt(t).replace(/[-_]/gm," ")||t,Ct=(t,e)=>t&&nt(t).split(/[\s_-]/gm).reduce((r,s,o)=>s?r+=(o>0||e)&&X(s)||s.toLowerCase():r,"")||t,N=t=>t==null?"":g(t)?t:JSON.stringify(t),pe=/[A-Z]/g,fe=/^ms-/,st={},de=t=>"-"+t.toLowerCase(),L=t=>typeof t=="number"&&t!=t,$=t=>typeof t=="number"&&!L(t),ot=t=>$(t)&&t>=0,Tt=t=>g(t)&&t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")||t,C=t=>typeof t=="object"&&t!==null,it=(t,e,r,s)=>{let o=t;if(!C(t)||!t||!e)return r!=="set"&&s||void 0;let a=p(e)?Array.from(e):e.split("."),l=a.pop(),f,j;for(;f=a.shift();){let S=t[f];if(C(S)||u(S)?t=S:(r==="set"?t[f]={}:j=!0,t=t[f]),j)return s}return r==="get"?l in t?t[l]:s:r==="unset"?delete t[l]:(t[l]=s)&&o||o},H=(t,e,r)=>it(t,e,"get",r),kt=(t,e,r="")=>{e=C(e)&&e||{};let s=kt.regex||/\${(.*?)\}/g;return g(t)?t.replace(s,(o,a)=>{let l=(a||o.substr(2,o.length-3)).trim(),f=H(e,l,r);return u(f)?f(e,l,r):f}):console.error("template requires a string as the first argument")||t},he=['"',"'"],at=t=>{if(!g(t))return;let e="";for(let r of t)e=r+e;return e},_t=(t,e,r)=>r.map(s=>t.indexOf(s,e)).sort().find(s=>s>=0),It=(t,e,r=[" "])=>{let s=_t(t,e,r);return t.substring(e,s===-1?t.length:s)},Q=t=>typeof t=="boolean",ct=t=>t==="false"||t==="true",Pt=t=>Q(t)?N(t):t&&t!=="false"&&t!=="0"?"true":"false",Ft=t=>Boolean(t||t===""||t===0),lt=t=>ct(t)?t==="true":Pt(t)==="true",B=t=>N(t).replace(/([^.\d])/gm,""),ut=t=>$(t)?t:t&&!L(t)&&Number(B(t))||0,Dt=t=>g(t)||$(t)||Q(t),pt=(t,e)=>{let[r]=d({x:t,y:e},{$default:Dt});return r?g(t)?t.localeCompare(e):t-e:null},ft=t=>t,Nt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),dt=t=>{let e=function(...r){return t instanceof e||H(t.prototype,"constructor.name")?new t(...r):t.apply(t,r)};for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return Object.defineProperty(e,"name",{value:t.name,configurable:!0}),e.toString=()=>t.toString(),e},k=(t,e=new WeakMap)=>{if(Object(t)!==t)return t;if(t instanceof Set)return new Set(t);if(e.has(t))return e.get(t);if(p(t))return t.map(s=>k(s));if(u(t))return dt(t);let r=t instanceof Date?new Date(t):t instanceof RegExp?new RegExp(t.source,t.flags):t.constructor?null:Object.create(null);return r===null?Lt(t):(e.set(t,r),t instanceof Map?Array.from(t,([s,o])=>r.set(s,k(o,e))):Object.assign(r,...Object.keys(t).map(s=>({[s]:k(t[s],e)}))))},Lt=t=>{if(!t)return t;let e=Object.getPrototypeOf(t),r=Object.getOwnPropertyDescriptors(t);for(let[o,a]of Object.entries(r))a.value&&(r[o].value=k(a.value));let s=Object.create(e,r);return Object.isFrozen(t)&&Object.freeze(s),Object.isSealed(t)&&Object.seal(s),s},Ut=t=>t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,Ut),Mt=t=>Object.prototype.toString.call(t).slice(8,-1),qt=(t,...e)=>{if(!e.length)return null;for(let r of e){if(!p(r)){console.error(`Matching case must be an entry (a 2-element array). Found: ${Mt(r)}`,r);break}let[s,o]=r;if(u(s)&&s(t)||s===t)return o}return null};qt.default=()=>!0;let zt=t=>m(t)?Object.keys(t).length===0:p(t)?t.length===0:g(t)?t.trim().length===0:!!$(t)&&t<1,ht=(t,e)=>{let[r]=d({arr:t,comparator:e},{arr:p,$default:u});return r&&t.length?t.reduce((s,o)=>e(s,o)>0?s:o):null},Ht=t=>p(t)?t.filter((e,r,s)=>s.indexOf(e)==r):t,Bt=(t,e)=>{if(!e)return Ht(t);let{unique:r}=t.reduce((s,o)=>{let a=e(o);return!s.set.has(a)&&s.unique.push(o),s.set.add(a),s},{unique:[],set:new Set});return r},Jt=(t,e=!0)=>C(t)?Object.keys(t).reduce((r,s)=>{let o=t[s];return o==null||(r[s]=e&&C(o)?Jt(o):o),r},m(t)&&{}||[]):console.error("cleanColl requires a collection as the first argument")||t,mt=(t,e,r)=>it(t,e,"set",r),Gt=Array.isArray,Wt=Object.keys,me=Object.prototype.hasOwnProperty,gt=(t,e)=>{if(t===e)return!0;if(!t||!e||typeof t!="object"||typeof e!="object")return t!=t&&e!=e;let r=Gt(t),s=Gt(e),o,a,l;if(r&&s){if(a=t.length,a!=e.length)return!1;for(o=a;o--!=0;)if(!gt(t[o],e[o]))return!1;return!0}if(r!=s)return!1;let f=t instanceof Date,j=e instanceof Date;if(f!=j)return!1;if(f&&j)return t.getTime()==e.getTime();let S=t instanceof RegExp,M=e instanceof RegExp;if(S!=M)return!1;if(S&&M)return t.toString()==e.toString();let Ot=Wt(t);if(a=Ot.length,a!==Wt(e).length)return!1;for(o=a;o--!=0;)if(!me.call(e,Ot[o]))return!1;for(o=a;o--!=0;)if(l=Ot[o],!gt(t[l],e[l]))return!1;return!0},Kt=t=>t&&g(t)?ct(t)?lt(t):$(t)?ut(t):(()=>{try{return JSON.parse(t)}catch{return t}})():t,yt,J="dir",U="type",ge=["error","info","log","dir","warn"],Xt=(...t)=>{if(!t.length)return;let e=t.length===1?J:t.pop();(yt||e==="error")&&(typeof t[0]=="string"&&(U==="type"?t[0]=`[ ${e.toUpperCase()} ] ${t[0]}`:U&&(t[0]=`${U} ${t[0]}`)),ge.indexOf(e)!==-1?console[e](...t):console[J](...t,e))},Qt=(t,e)=>{t&&Object.entries(t).map(([r,s])=>{e&&e.indexOf(r)!==-1||(typeof s=="object"&&Qt(s),t[r]=void 0,delete t[r])})},Vt=(...t)=>t.reduce((e,r)=>{let s=k(r);return p(s)?[...p(e)&&e||[],...s]:m(s)?Object.entries(s).reduce((o,[a,l])=>({...o,[a]:u(l)?dt(l):C(l)&&a in o?Vt(o[a],l):k(l)}),e):e},p(t[0])&&[]||{}),Zt=t=>p(t)&&t.length===2&&($(t[0])||g(t[0])),Yt=(t,e)=>{if(!p(t)&&!m(t))return console.error(t,"Expected array or object for obj. Found "+typeof t),t;if(!u(e))return console.error("Expected function for cb. Found "+typeof e),t;let r=Object.entries(t),s=p(t)?[]:{};return r.reduce((o,[a,l])=>{let f=e(a,l);return Zt(f)?mt(o,f[0],f[1]):(console.error(`Callback function must return entry. Found: ${f}. Using current entry instead.`),mt(o,a,l))},s)},G=(t,e,r={})=>m(t)&&u(e)&&Object.entries(t).reduce((s,[o,a])=>e(o,a,s),r)||r,bt=t=>{if(!u(t))throw"Argument must be a function";return(...e)=>new Promise((r,s)=>u(e[e.length-1])?(e.pop(),e.push((...o)=>o&&o[0]?s(...o):r(...o)),t(...e)):r(t(...e)))},ye=Array.from(["caller","callee","arguments","apply","bind","call","toString","__proto__","__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","valueOf","toLocaleString"]).concat(Object.getOwnPropertyNames(Object.prototype)).reduce((t,e)=>(t[e]=!0,t),{}),te=t=>{if(!t.__IS_PROMISIFIED__){for(let e of Object.getOwnPropertyNames(t))if(!(e.indexOf("Async")!==-1||t[`${e}Async`])&&!ye[e])if(u(t[e]))t[`${e}Async`]=bt(t[e]);else{let r=Object.getOwnPropertyDescriptor(t,e).get;u(r)&&(t[`${e}Async`]=bt(r))}t.__IS_PROMISIFIED__=!0}return t},ee=t=>Boolean(t&&t instanceof RegExp),re=t=>ee(t)?t.source:g(t)?t:null,ne=t=>{let e={},r=t.split("?"),s=r[r.length-1];if(!s)return e;let o=s.split("&");return o.length&&o.map(a=>{let l=a.split("=");if(l.length<=1)return e;let f=[l.shift(),l.join("=")];if(f.length===2){let j=decodeURIComponent(f[1]).split(",");if(j&&j.length>1)e[f[0]]=j;else if(f[0]in e){let S=e[f[0]];e[f[0]]=p(S)?S.push(decodeURIComponent(f[1])):[S,decodeURIComponent(f[1])]}else e[f[0]]=decodeURIComponent(f[1])}}),e};n.applyToCloneOf=(t,e)=>{let r;if(t||(r="object (Argument 1) in applyToCloneOf, must be defined!"),m(t)||(r="object (Argument 1) in applyToCloneOf, must be an object!"),e||(r="mutator (Argument 2) in applyToCloneOf, must be defined!"),u(e)||(r="mutator (Argument 2) arg in applyToCloneOf, must be a function!"),r)return console.warn(r)||t;let s=k(t);return e(s),s},n.applyToFunc=St,n.areCountMapsEqual=w,n.areFrequencyEqual=(t,e)=>{let[r]=d({arr:t,otherArr:e},{$default:p});if(!r)return null;if(t===e)return!0;if(t.length!==e.length)return!1;let s=E(t),o=E(e);return w(s,o)},n.areSetEqual=(t,e)=>{let[r]=d({arr:t,otherArr:e},{$default:p});if(!r)return null;if(t===e)return!0;let[s,o]=t.length>e.length?[t,e]:[e,t],a=new Set(o);for(let l=0;l<s.length;l++){let f=s[l];if(!a.has(f))return!1}return!0},n.buildElementCountMap=E,n.buildPath=(...t)=>t.reduce((e,r)=>{let s=toStr(r);return`${e}${s&&"/"+s||""}`},"").replace(/([^:\/]|^)\/{2,}/g,"$1/"),n.camelCase=Ct,n.camelCasePath=t=>{let e=t.split(".").map((r,s)=>s>0?X(r,!1):r);return e.length>1?e.join(""):t},n.capitalize=X,n.checkCall=(t,...e)=>u(t)?t(...e):void 0,n.cleanColl=Jt,n.cleanStr=nt,n.clearObj=Qt,n.cloneArr=t=>Array.from([...p(t)&&t||m(t)&&Object.entries(t)||[]]),n.cloneFunc=dt,n.cloneJson=t=>{try{return JSON.parse(JSON.stringify(t))}catch(e){return Xt(e.message,"error"),null}},n.cloneObjWithPrototypeAndProperties=Lt,n.compareTo=pt,n.complement=t=>{let[e]=d({predicate:t},{predicate:u});return e?(...r)=>!t(...r):null},n.containsStr=(t,e,r)=>(t=!g(t)&&N(t)||t,e=!g(e)&&N(e)||e,t.indexOf(e,r)!==-1),n.convertToStrBool=Pt,n.debounce=(t,e=250,r=!1)=>{let s;return function(...o){if(!u(t))return null;let a=this,l=r&&!s;return clearTimeout(s),s=setTimeout(()=>{s=null,!r&&t.apply(a,o)},e),l?u(t)&&t.apply(a,o):void 0}},n.deepClone=k,n.deepEqual=gt,n.deepFreeze=x,n.deepMerge=Vt,n.delimitString=Et,n.doIt=(...t)=>{let e=t.slice(),r=e.shift(),s=e.shift(),o=e.pop();if(!$(r)||!u(o))return[];let a=new Array(r),l=[];for(let f=0;f<a.length;f++){let j=o.call(s,f,...e);if(j===!1)break;l.push(j)}return l},n.either=(t,e,r)=>u(r)?r(t,e)&&t||e:Ft(t)&&t||e,n.eitherArr=(t,e)=>p(t)?t:e,n.eitherFunc=(t,e)=>u(t)&&t||e,n.eitherObj=(t,e)=>m(t)&&t||e,n.eitherStr=(t,e)=>g(t)&&t||e,n.ensureArr=R,n.equalsNaN=L,n.everyEntry=(t,e)=>t?m(t)?u(e)?rt(t,Object.entries,r=>r.every(([s,o])=>e(s,o))):(console.error(`Argument 'predicate' passed into everyEntry must a function. Found: ${e}`),!1):(console.error(`Argument obj ${t} must be an object.`),!1):(console.error(`everyEntry expects argument obj [${t}] to be defined.`),!1),n.exists=P,n.filterObj=(t,e)=>t&&(m(t)?u(e)?G(t,(r,s,o)=>(e(r,s)&&(o[r]=s),o),{}):(console.error(`Argument 'predicate' passed into filterObject must a function. Found: ${e}`),t):(console.error(`Object ${t} was not an object. It must be for filterObject`),t)),n.findExtrema=ht,n.findMax=(t=[],e=ft)=>ht(t,(r,s)=>pt(e(r),e(s))),n.findMin=(t=[],e=ft)=>ht(t,(r,s)=>pt(e(s),e(r))),n.flatArr=z,n.flatMap=(t,e)=>{let[r]=d({arr:t,mapFn:e},{arr:p,mapFn:u});return r?t.reduce((s,o)=>{let a=e(o);return p(a)?a.map(l=>s.push(l)):s.push(a),s},[]):t},n.flatUnion=(...t)=>{let e=t.pop(),r={exists:!0},s=u(e)?e:t.push(e)&&void 0;return t.reduce((o,a)=>p(a)?Bt(z([...o,...a],r),s):o,[])},n.get=H,n.getNearestDelimiterIndex=_t,n.getNums=B,n.getRegexSource=re,n.getURLParam=t=>{var e,r,s;let[o]=d({paramKey:t},{paramKey:g});if(!o)return null;let a=typeof document<"u"?document:null,l=a==null||(e=a.location)===null||e===void 0?void 0:e.search;return g(l)&&(r=(s=ne(l))===null||s===void 0?void 0:s[t])!==null&&r!==void 0?r:null},n.getWordEndingAt=(t,e,r=[" "])=>{let s=at(t),o=t.length-e;return at(It(s,o,r))},n.getWordStartingAt=It,n.hasDomAccess=()=>{try{return!(typeof window>"u"||!window.document||!window.document.createElement)}catch{return!1}},n.hasOwn=Nt,n.hashString=(t,e)=>{if(!g(t)||t.length==0)return 0;t=t.split("").reverse().join("");let r=0;for(let s=0;s<t.length;s++)r=(r<<5)-r+t.charCodeAt(s),r=`${Math.abs(r&r)}`;return ot(e)?r.slice(0,e):r},n.hyphenator=t=>{if(st.hasOwnProperty(t))return st[t];let e=t.replace(pe,de);return st[t]=fe.test(e)?"-"+e:e},n.identity=ft,n.isArr=p,n.isArrMap=t=>{if(!m(t))return!1;let e=Object.values(t);return lt(e.length&&e.every(p))},n.isBool=Q,n.isColl=C,n.isEmail=t=>!t||!g(t)?!1:Boolean(/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(t)),n.isEmpty=zt,n.isEmptyColl=t=>p(t)?t.length===0:C(t)&&Object.getOwnPropertyNames(t).length===0,n.isEntry=Zt,n.isFloat=t=>$(t)&&t%1!=0,n.isFunc=u,n.isInt=t=>$(t)&&t%1==0,n.isLowerCase=xt,n.isNegative=t=>$(t)&&t<0,n.isNonNegative=ot,n.isNum=$,n.isObj=m,n.isOrderable=Dt,n.isPhone=t=>!t||!g(t)?!1:Boolean(/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im.test(t))&&t.replace(/\D/g,"").length<11,n.isPositive=t=>$(t)&&t>0,n.isQuoted=(t,e=he)=>g(t)&&e.some(r=>t.startsWith(r)&&t.endsWith(r)),n.isRegex=ee,n.isSame=(t,e)=>t===e?t!==0||1/t==1/e:t!=t&&e!=e,n.isStr=g,n.isStrBool=ct,n.isUpperCase=vt,n.isUrl=t=>Boolean(/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/.test(t)),n.isUuid=t=>!t||!g(t)?!1:Boolean(/^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(t)),n.isValidDate=t=>!isNaN((t instanceof Date&&t||new Date(t)).getTime()),n.isValidUrl=t=>/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?/.test(t),n.joinRegex=(...t)=>{let[e,r]=(o=>{if(p(o[0]))return[o[0],o[1]];let a=o[o.length-1],l=g(a)?a:void 0;return[l?o.splice(0,o.length-1):o,l]})(t),s=e.reduce((o,a)=>{let l=re(a);return l?o===""?l:`${o}|${l}`:o},"");return new RegExp(`(${s})`,r)},n.jsonEqual=(t,e)=>{try{return JSON.stringify(t)===JSON.stringify(e)}catch{return!1}},n.keyMap=(t,e)=>p(t)&&t.reduce((r,s)=>{if(!g(s))return r;let o=e&&s.toUpperCase()||s;return r[o]=o,r},{})||{},n.limbo=t=>t&&u(t.then)?t.then(e=>[null,e]).catch(e=>[e,void 0]):[new Error("A promise or thenable is required as the first argument!"),null],n.logData=Xt,n.mapColl=(t,e)=>u(e)&&C(t)?Object.keys(t).map(r=>e(r,t[r],t)):p(t)?[]:{},n.mapEntries=Yt,n.mapFind=(t,e,r=P)=>{let[s]=d({coll:t,mapper:e,test:r},{coll:C,$default:u});if(s)return m(t)?((o,a,l)=>{let f=0;for(let j in o){if(!o.hasOwnProperty(j))continue;let S=a(o[j],j,f);if(l(S,j,f))return S;f++}return null})(t,e,r):((o,a,l)=>{for(let f=0;f<o.length;f++){let j=a(o[f],f,f);if(l(j,f,f))return j}return null})(t,e,r)},n.mapKeys=(t,e)=>m(t)&&u(e)?Yt(t,(r,s)=>[e(r),s]):t,n.mapObj=(t,e)=>m(t)&&u(e)&&Object.entries(t).map(([r,s])=>e(r,s))||t,n.mapString=At,n.match=qt,n.memorize=(t,e,r=1)=>{if(!u(t)||e&&!u(e))return console.error("Error: Expected a function",t,e);let s=function(){let o=s.cache,a=e?e.apply(this,arguments):arguments[0];if(Nt(o,a))return o[a];let l=t.apply(this,arguments);return $(r)&&Object.keys(o).length<r?o[a]=l:s.cache={[a]:l},l};return s.cache={},s.destroy=()=>{e=void 0,s.cache=void 0,s.destroy=void 0,s=void 0},s},n.mod=(t,e)=>(t%e+e)%e,n.noOp=()=>{},n.noOpObj=O,n.noPropArr=I,n.noPropObj=D,n.nth=t=>{if(!$(t)&&(!(t=B(t))||(t=ut(t),L(t))))return"";let e=t%100;if(e>=10&&e<=20)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},n.objToQuery=t=>{let e;return G(t,(r,s,o)=>{if(!s)return o;let a=g(s)||$(s)||Q(s)?s:C(s)?p(s)?s.join(","):JSON.stringify(s):null;return a&&(o=e?`${o}&${encodeURIComponent(r)}=${encodeURIComponent(a)}`:`?${encodeURIComponent(r)}=${encodeURIComponent(a)}`,e=!0),o},"")},n.omitKeys=(t={},e=[])=>m(t)&&G(t,(r,s,o)=>(e.indexOf(r)===-1&&(o[r]=t[r]),o),{})||{},n.omitRange=(t,e,r)=>{let[s]=d({arr:t,startIndex:e,count:r},{arr:p,$default:ot});if(!s)return t;let o=[...t];return o.splice(e,r),o},n.parseErrorMessage=t=>g(t)&&!zt(t)?t:m(t)?t.message:null,n.parseJSON=(t,e=!0)=>{try{return JSON.parse(t)}catch(r){return e&&console.error(r.message),null}},n.pickKeys=(t={},e=[])=>m(t)&&e.reduce((r,s)=>(s in t&&(r[s]=t[s]),r),{})||{},n.pipeline=rt,n.plural=t=>t&&t.length&&t[t.length-1]!=="s"?t+"s":t,n.promisify=bt,n.promisifyAll=t=>{if(!m(t))return t;te(t);let e=Object.getPrototypeOf(t);return e&&Object.getPrototypeOf(e)!==null&&te(e),t},n.queryToObj=ne,n.randomArr=(t,e)=>{if(!p(t))return t;let r=e||1,s=[];for(let o=0;o<r;o++)s.push(t[Math.floor(Math.random()*t.length)]);return e?s:s[0]},n.randomizeArr=t=>!p(t)&&t||t.sort(()=>.5-Math.random()),n.reduceColl=(t,e,r)=>u(e)&&C(t)?Object.keys(t).reduce((s,o)=>e(o,t[o],t,s),r):p(t)?[]:{},n.reduceObj=G,n.removeDot=Rt,n.repeat=(t,e,r=!1)=>{if(!e||e<=0)return[];if(!$(e))return console.error("Times argument must be a number"),[];let s=[];for(let o=0;o<e;o++){let a=u(t)?t():r?k(t):t;s.push(a)}return s},n.resetLogs=()=>{yt=void 0,J="log",U="type"},n.reverseStr=at,n.runSeq=async(t=[],e={})=>{let[r]=d({asyncFns:t},{asyncFns:p});if(!r)return[];let{cloneResults:s=!1,returnOriginal:o=!0}=e,a=[];for(let l of t){let f=u(l)?await l(a.length,s?k(a):a):o?l:void 0;a.push(f)}return a},n.sanitize=Tt,n.sanitizeCopy=t=>JSON.parse(Tt(JSON.stringify(t))),n.set=mt,n.setLogs=(t,e,r)=>{yt=t,J=e||J||"log",U=r||U||"type"},n.shallowEqual=(t,e,r)=>{if(r&&(p(r)||g(r))&&(t=H(t,r),e=H(e,r)),t===e)return!0;if(!(t&&C(t)&&e&&C(e))||Object.keys(t).length!==Object.keys(e).length)return!1;for(let s in t)if(t[s]!==e[s])return!1;return!0},n.singular=t=>t&&t.length&&t[t.length-1]==="s"?t.slice(0,t.length-1):t,n.snakeCase=t=>Et(t,"_").toLowerCase(),n.softFalsy=Ft,n.someEntry=(t,e)=>t?m(t)?u(e)?rt(t,Object.entries,r=>r.some(([s,o])=>e(s,o))):(console.error(`Argument 'predicate' passed into someEntry must a function. Found: ${e}`),!1):(console.error(`Argument obj ${t} must be an object.`),!1):(console.error(`someEntry expects argument obj [${t}] to be defined.`),!1),n.spaceJoin=(t,e)=>(e=p(e)?e:[e]).reduce((r,s)=>g(s)?`${r?r+" ":""}${s}`.trim():r,g(t)?t:""),n.splitByKeys=(t={},e)=>{if(!e)return[{},{...t}];let r=[{},{}],s=R(e);return m(t)?G(t,(o,a,l)=>(P(s.find(f=>P(f)&&N(f)===o))?l[0][o]=t[o]:l[1][o]=t[o],l),r):r},n.strToType=Kt,n.styleCase=t=>{if(!g(t))return t;let e=Ct(t);return`${e[0].toLowerCase()}${e.slice(1)}`},n.template=kt,n.throttle=(t,e=100)=>{let r=!1;return function(...s){if(!r)return r=!0,t.apply(this,s),setTimeout(()=>{r=!1},e)}},n.throttleLast=(t,e,r=100)=>{let s;return function(...o){s&&clearTimeout(s),s=setTimeout(()=>{t.apply(this,o),clearTimeout(s)},r),typeof e=="function"&&e()}},n.timedRun=async(t,...e)=>{let[r]=d({fn:t},{fn:u});if(!r)return[void 0,-1];let s=new Date;return[await t(...e),new Date-s]},n.toBool=lt,n.toFloat=t=>t&&!L(t)&&parseFloat($(t)&&t||B(t))||0,n.toInt=t=>t&&!L(t)&&parseInt($(t)&&t||B(t))||0,n.toNum=ut,n.toObj=(t,e,r)=>p(t)?Object.keys(t).reduce((s,o)=>(s[o]=t[o],s),{}):g(str)?(e=e||"=",r=r||"&",str.split(r).reduce((s,o)=>{let a=o.split(e);return s[a[0].trim()]=Kt(a[1].trim()),s},{})):{},n.toStr=N,n.trainCase=t=>g(t)&&t.split(/(?=[A-Z])|[\s_-]/gm).join("-").toLowerCase()||t,n.trimStringFields=t=>Object.entries(t).reduce((e,[r,s])=>(e[r]=g(s)?s.trim():s,e),t),n.typeOf=Mt,n.uniqArr=Bt,n.uniqArrByReference=Ht,n.unset=(t,e)=>it(t,e,"unset"),n.uuid=Ut,n.validFilename=t=>t?!(/[<>:"/\\|?*\u0000-\u001F]/g.test(t)||/^(con|prn|aux|nul|com\d|lpt\d)$/i.test(t)||/^\.\.?$/.test(t)):!1,n.validate=d,n.wait=t=>new Promise(e=>setTimeout(()=>e(!0),t)),n.wordCaps=t=>g(t)?nt(t).split(" ").map(e=>e&&X(e)||"").join(" "):t})});var ke={};Ae(ke,{ParkinTest:()=>$t});module.exports=xe(ke);var wt=jt(Y());var T=jt(Y()),tt=(0,T.keyMap)(["beforeAll","beforeEach","afterAll","afterEach"]),ve={...(0,T.keyMap)(["test","it","xtest","xit","describe"]),...tt},y={...ve,...(0,T.keyMap)(["root"])};var _=n=>{throw new Error(n)},ie=(n,i)=>{!(0,T.isFunc)(i)&&_(`The ${n} method requires a "function" as the first argument`)},ae=n=>{n.type!==y.root&&_(`Invalid root type "${n.type}" set for root object`),!n.describes||!n.describes.length&&_("No tests have been registered to this ParkinTest instance")},Ee=(n,i,c)=>{!(0,T.isStr)(n)&&_("Test item type is required as a string"),!(0,T.isFunc)(c)&&_(`The ${n} method requires a "function" as the second argument`),!(0,T.isStr)(i)&&_(`The ${n} method requires a "string" as the first argument`)},W=(n,i=T.noOpObj,c=!0)=>{let{description:d,action:h}=i;return c&&Ee(n,d,h),{...i,type:n}},ce=(n,i)=>{let c=W(y.describe,{...et(),action:i,tests:[],description:n});return c.disabled=()=>c.skip=!0,c},et=()=>W(y.root,{describes:[],...Object.values(tt).reduce((n,i)=>(n[i]=[],n),{})},!1);var K=(n,{id:i,fullName:c,action:d,failed:h,passed:b,testPath:A})=>{let p={id:i,action:d,testPath:A,fullName:c,type:n.type,failedExpectations:[],passedExpectations:[],failed:Boolean(h),passed:Boolean(b),description:n.description,timestamp:new Date().getTime()};return(0,wt.isObj)(h)&&p.failedExpectations.push(h),(0,wt.isObj)(b)&&p.passedExpectations.push(b),(b||h)&&(p.status=b?"passed":"failed"),p},F=async n=>{let{type:i,test:c,specId:d,suiteId:h,describe:b,root:A}=n,p,E=A||b,w=A?A.description:c?`${b==null?void 0:b.description} > ${c==null?void 0:c.description} > ${i}`:`${b==null?void 0:b.description} > ${i}`;try{E[i].length&&await Promise.all(E[i].map((m,R)=>(p=R,m())))}catch(m){return K(E,{fullName:w,action:i,status:"failed",id:c?d:h,failed:{name:m.name,message:m.message},testPath:c?`/${h}/${d}/${i}${p}`:`/${h}/${i}${p}`})}},Re=async n=>{let{suiteId:i,describe:c,testOnly:d,specDone:h,specStarted:b}=n,A=!1,p=[];for(let E=0;E<c.tests.length;E++){let w=c.tests[E],m=`spec${E}`,R=`/${i}/${m}`,u=`${c.description} > ${w.description}`,x=K(w,{fullName:u,testPath:R,id:m,action:"start"});if(d&&!w.only||w.skip){b({...x,skipped:!0,action:"skipped",status:"skipped"});continue}else b(x);let O=await F({test:w,specId:m,suiteId:i,describe:c,type:y.beforeEach});if(O){A=!0,p.push(O),h(O);break}try{let I=await w.action();x=K(w,{fullName:u,id:m,testPath:R,action:y.test,passed:I||!0})}catch(I){x=K(w,{fullName:u,id:m,action:y.test,testPath:R,failed:{name:I.name,message:I.message}}),A=!0}let D=await F({test:w,specId:m,suiteId:i,describe:c,type:y.afterEach});if(D){A=!0,p.push(D),h(D);break}p.push(x),h({...x,action:"end"})}return{tests:p,failed:A}},Ce=async({root:n,suiteId:i,describe:c})=>{let d=await F({root:n,suiteId:y.root,type:y.beforeEach}),h=!d&&await F({suiteId:i,describe:c,type:y.beforeAll});return d||h},Te=async({root:n,suiteId:i,describe:c})=>{let d=await F({root:n,suiteId:y.root,type:y.afterEach}),h=!d&&await F({suiteId:i,describe:c,type:y.afterAll});return d||h},le=async n=>{let{root:i,testOnly:c,specDone:d,suiteDone:h,specStarted:b,parentIdx:A="",suiteStarted:p,describeOnly:E}=n,w=!1,m=[];for(let R=0;R<i.describes.length;R++){let u=i.describes[R],x=`suite-${A}${R}`,O=K(u,{id:x,action:"start",testPath:`/${x}`,fullName:u.description});if(u.skip||E&&!u.only&&!u.onlyChild||c&&!u.onlyChild){p({...O,skipped:!0,action:"skipped",status:"skipped"});continue}else p(O);let I=await Ce({root:i,suiteId:x,describe:u});if(I){w=!0,O={...O,...I},h(O),m.push(O);continue}let P=await Re({suiteId:x,describe:u,testOnly:c,specDone:d,specStarted:b}),q=u.describes&&u.describes.length&&await le({...n,root:u,parentIdx:`${R}-`});O={...O,...q,action:"end",tests:P.tests},P.failed||q.failed?(w=!0,O.failed=!0):O.passed=!0;let z=await Te({root:i,suiteId:x,describe:u});if(z){w=!0,O={...O,...z},h(O),m.push(O);continue}h(O),m.push(O)}return{describes:m,failed:w}},ue=async n=>{ae(n.root);let i=await F({root:n.root,suiteId:y.root,type:y.beforeAll});if(i)return[i];let{describes:c}=await le(n),d=await F({root:n.root,suiteId:y.root,type:y.afterAll});return d&&c.push(d),c};var v=jt(Y());var $t=class{timeout=6e3;#i=v.noOp;#a=v.noOp;#c=v.noOp;#l=v.noOp;#t=void 0;#r=!1;#n=!1;#s=!0;#e=et();constructor(i=v.noOpObj){this.#e.description=i.description||"root",this.#u(),this.#p(),this.#f(),this.it=this.test,this.xit=this.xtest,this.#t=this.#e,this.#o(i)}run=(i=v.noOpObj)=>{i.description&&(this.#e.description=i.description),this.#o(i);let c=ue({root:this.#e,testOnly:this.#r,specDone:this.#i,suiteDone:this.#a,specStarted:this.#c,describeOnly:this.#n,suiteStarted:this.#l});return this.#s&&this.clean(),c};clean=()=>{this.timeout=6e3,this.#s=!0,this.#r=!1,this.#n=!1,this.#t=void 0,this.#e=void 0,this.#e=et(),this.#t=this.#e};getActiveParent=()=>this.#t;setConfig=i=>this.#o(i||v.noOpObj);#o=({timeout:i,autoClean:c,specDone:d,suiteDone:h,specStarted:b,suiteStarted:A})=>{i&&(this.timeout=i),d&&(this.#i=d),h&&(this.#a=h),b&&(this.#c=b),A&&(this.#l=A),c===!1&&(this.#s=c)};#u=()=>{this.describe.only=(...i)=>{this.describe(...i);let c=this.#t.describes[this.#t.describes.length-1];c.only=!0,this.#n=!0,(0,v.checkCall)(this.#t.hasOnlyChild)},this.test.only=(...i)=>{this.test(...i);let c=this.#t.tests[this.#t.tests.length-1];c.only=!0,this.#r=!0,(0,v.checkCall)(this.#t.hasOnlyChild)}};#p=()=>{this.describe.skip=(...i)=>{this.describe(...i);let c=this.#t.describes[this.#t.describes.length-1];c.skip=!0},this.test.skip=(...i)=>{this.test(...i);let c=this.#t.tests[this.#t.tests.length-1];c.skip=!0}};#d=()=>{};#f=()=>{Object.values(tt).map(i=>{this[i]=c=>{ie(i,c),this.#t[i].push(c)}})};describe=(i,c)=>{let d=ce(i,c);this.#t.describes.push(d);let h=this.#t;d.hasOnlyChild=()=>{d.onlyChild=!0,(0,v.checkCall)(h.hasOnlyChild)},this.#t=d,c(),this.#t=h};test=(i,c,d)=>{(!this.#t||this.#t.type===y.root)&&_(`All ${y.test} method calls must be called within a ${y.describe} method`);let h=W(y.test,{action:c,timeout:d,description:i});h.disabled=()=>h.skip=!0,this.#t.tests.push(h)};xtest=i=>{(!this.#t||this.#t.type===y.root)&&_(`All ${y.test} method calls must be called within a ${y.describe} method`),!(0,v.isStr)(i)&&_(`The ${y.test} method requires a "string" as the first argument`);let c=W(y.test,{description:i,skip:!0},!1);c.disabled=()=>c.skip=!0,this.#t.tests.push(c)}};0&&(module.exports={ParkinTest});
//# sourceMappingURL=index.js.map
